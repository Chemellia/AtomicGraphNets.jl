<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Comparison with cgcnn.py · AtomicGraphNets.jl</title><link rel="canonical" href="https://aced-differentiate.github.io/AtomicGraphNets.jl/stable/comparison/"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">AtomicGraphNets.jl</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../graph_theory/">Basic Graph Theory</a></li><li><a class="tocitem" href="../gcnns/">GCNNs</a></li><li class="is-active"><a class="tocitem" href>Comparison with cgcnn.py</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../examples/example_1/">Example 1</a></li><li><a class="tocitem" href="../examples/example_2/">Example 2</a></li></ul></li><li><span class="tocitem">Functions</span><ul><li><a class="tocitem" href="../functions/layers/">Layers</a></li><li><a class="tocitem" href="../functions/models/">Models</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Comparison with cgcnn.py</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Comparison with cgcnn.py</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/aced-differentiate/AtomicGraphNets.jl/blob/master/docs/src/comparison.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Comparison-of-AtomicGraphNets.jl-and-cgcnn.py"><a class="docs-heading-anchor" href="#Comparison-of-AtomicGraphNets.jl-and-cgcnn.py">Comparison of AtomicGraphNets.jl and cgcnn.py</a><a id="Comparison-of-AtomicGraphNets.jl-and-cgcnn.py-1"></a><a class="docs-heading-anchor-permalink" href="#Comparison-of-AtomicGraphNets.jl-and-cgcnn.py" title="Permalink"></a></h1><p>AtomicGraphNets.jl provides a model-builder for the typical GCNN architecture called <code>Xie_model</code>; in reference to <a href="http://txie.me/">Tian Xie</a>, the original developer of <a href="https://github.com/txie-93/cgcnn">cgcnn.py</a>.<br/>However, there are some differences between how AtomicGraphNets models and those ones work, particularly with respect to the convolutional operation performed.</p><p>The <a href="https://github.com/txie-93/cgcnn">cgcnn.py</a> package was the first major package to implement atomic graph convolutional networks.<br/>However, the &quot;convolutional&quot; operation they use, while qualitatively similar, is not convolution by the strict definition involving the graph Laplacian. In their package, they introduce two such operations.</p><p>The first operation is expressed as follows.</p><p class="math-container">\[\begin{aligned}
v^{(t+1)}_{i} = g [\big(\sum\limits_{j,k}v^{(t)}_{j} \oplus u_{(i,j)_{k}}\big)W^{(t)}_{c} + v^{(t)}_{i}W^{(t)}_{s} + b^{(t)}]
\end{aligned}\]</p><p>Here, <span>$v$</span>, <span>$u$</span> represent node features and edge features respectively, and <span>$i$</span>, <span>$j$</span>, <span>$k$</span> index nodes, neighbors of nodes, and edge multiplicities respectively. Further, <span>$\oplus$</span> indicates concatenation, and <span>$g$</span> is an activation function.</p><p>Note that such an operation, which does not make use of the graph Laplacian, requires explicit computation of neighbor lists for every node, and that the convolutional weight matrix is of very large dimension due to the concatenation step.</p><p>The original CGCNN paper explores the following slightly more complicated operation that resulted in better performance.</p><p class="math-container">\[\begin{aligned}
v^{(t+1)}_i = v^{(t)}_i + \sum\limits_{j,k}\sigma(z^{(t)}_{(i,j)_{k}}W^{(t)}_{f} + b^{(t)}_{f}) \odot g(z^{(t)}_{(i,j)_{k}}W^{(t)}_{s} + b^{(t)}_{s})
\end{aligned}\]</p><p>where <span>$z$</span> is a concatenation of neighbor features and edge features, and <span>$\odot$</span> indicates element-wise multiplication.<br/>This operation entails yet more trainable parameters, and neither operation is particularly performant because the concatenation operation must be done at each step of the forward pass.</p><p>The operation implemented in AtomicGraphnets is as follows.</p><p class="math-container">\[\begin{aligned}
X^{(t+1)} = n_{z}\big(g(W^{(t)}_{c} \cdot X^{(t)} \cdot L + W^{(t)}_{s} \cdot X^{(t)} + B^{(t)})\big)
\end{aligned}\]</p><p>where <span>$X$</span> is a feature matrix constructed by stacking feature vectors, <span>$B$</span> is a bias matrix (stacked identical copies of the per-feature bias vector) and <span>$n_{z}$</span> is the z-score normalization (or regularized normalization operation), which we have found to improve stability.</p><p>In addition, since the graph Laplacian need only be computed once (and is in fact stored as part of the <code>AtomGraph</code> type), the forward pass is much more computationally efficient. Since no concatenation occurs, weight matrices are also smaller, meaning the model has fewer trainable parameters, and no sacrifice in accuracy that we have been able to observe, indicating comparable expressivity.</p><p>It is worth noting that one advantage of the <a href="https://github.com/txie-93/cgcnn">cgcnn.py</a> approach is that it allows for explicitly enumerating edge features. In the current version of AtomicGraphNets, the only features of graph edges are their weights. Convolutional operations that allow for edge features are under consideration for future versions.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../gcnns/">« GCNNs</a><a class="docs-footer-nextpage" href="../examples/example_1/">Example 1 »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Monday 22 March 2021 23:46">Monday 22 March 2021</span>. Using Julia version 1.5.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
